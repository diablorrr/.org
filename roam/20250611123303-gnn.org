:PROPERTIES:
:ID:       d687dc43-4cbb-411e-97b5-28050a471c88
:END:
#+title: GNN
#+filetags: paper

* 图是什么？
- 顶点和边构造的数据结构
- 顶点表示实体，边表示关系[fn:1]，整个图表示全局信息
- 顶点、边、整个图都有属性
* 为什么使用图这个数据结构？
- 语义信息丰富，更能表示多个实体之间存在复杂 *关系* 的数据
* 数据如何表示为图？
- 图像 :: 每个像素点都是一个顶点，每个像素与其8个方向的像素构成边
- 文本 :: 每个词都是一个顶点，句子中词的顺序构成边
- 其他 :: 分子图、社交网络、推荐系统...
* -----------------------------------------------
* 什么是图神经网络(GNN)？图结构在GNN中是如何表示的？有哪些GNN？GNN的应用？
- 专门用于处理 *图结构数据* 的神经网络，且输出图结构与输入图保持一致
- 顶点向量、边向量、全局向量(代表整个图)
- [[id:fc363b16-a8a1-4c0b-ab49-2f5f06019afd][GCN]](图卷积网络)、[[id:ccaa67c2-b762-4082-bc9a-2b5add79b8be][GAT]](图注意力网络)...
- 社交网络、图片内容关系、推荐系统...
* GNN的工作流程？ :ATTACH:
:PROPERTIES:
:ID:       6f181605-2b8c-4d1c-8d24-74be6e87946e
:END:
[[attachment:_20250611_165758screenshot.png]]
- 输入图 => GNN blocks => 输出图 => 全连接层[fn:2] => 预测值
* GNN blocks里面大概长什么样？
- 可能有3个MLP，分别处理顶点向量、边向量、全局向量 => 处理完输入图后，生成的输出图只是属性改变，图结构不变
* GNN blocks如何去考虑图的结构信息？
- 使用信息传递 :: 对邻居向量(可以是顶点、边、全局)进行pooling(汇聚)操作[fn:3]，再传入MLP，再传入下一层，因此随着层数的加深，后续顶点汇聚的信息越来越多[fn:4]
* 如何用GNN进行预测？
- (顶点、边、整个图) 预测3者中的任意1个可以用3者中的任意几个预测，若被预测的元素本身没有值，可以使用pooling操作。具体解释[fn:5]
* -----------------------------------------------
* 参考
1. [[https://www.bilibili.com/video/BV1iT4y1d7zP/?spm_id_from=333.337.search-card.all.click&vd_source=4441bc96046659b39d059d583f36ff52][李沫]]
2. [[https://distill.pub/2021/gnn-intro/][A Gentle Introduction to Graph Neural Networks]]

* Footnotes

[fn:1]
根据关系的方向分为有向边、无向边

[fn:2]
比如我需要2分类输出，我就定义一个输出为2的全连接层，再softmax；n分类，就定义输出为n的全连接层，再softmax；回归任务，就是1输出的全连接层

[fn:3]
比如：sum、max、mean

[fn:4]
eg：最后一层的一个节点相当于汇聚了很多很多节点信息

[fn:5]
- 预测顶点 :: 用本身顶点的值预测；也能用边的值预测；前面的情况都能与全局向量(整个图的信息)结合使用
  1. 本身顶点有值：在GNN blocks后增加全连接层(上述的任务层)，输出图中的顶点的值就是预测值
  2. 本身顶点无值：在GNN blocks之前使用pooling，汇聚邻居的值
- 预测边 :: 可以用与边相连的顶点的值预测，也能与全局向量(整个图的信息)结合使用
- 预测全局(整个图) :: 可以使用整个图中的顶点、边来预测
